(this["webpackJsonpwww-player"]=this["webpackJsonpwww-player"]||[]).push([[0],{104:function(t,e,a){},181:function(t,e,a){},182:function(t,e,a){"use strict";a.r(e);var n=a(1),r=a.n(n),s=a(10),c=a.n(s),i=(a(104),a(22)),o=a.n(i),u=a(32),d=a(17),l=a(18),p=a(20),b=a(19),j=a(39),f=a.n(j),h=a(186),g=a(185),v=a(184),m=a(187),O=a(11),x=function(t){Object(p.a)(a,t);var e=Object(b.a)(a);function a(t){var n;Object(d.a)(this,a),(n=e.call(this,t)).deviceId="",n.ws=void 0,n.hbStarted=!1,n.registered=!1,n.registerResp=!1,n.reg=void 0,n.canvas=void 0,n.context=void 0,n.componentDidMount=function(){n.init()},n.init=function(){var t=n.props.baseUrl,e="https:"==document.location.protocol,a="".concat(e?"wss:":"ws:","//").concat(t,":8080"),r=new window.WebSocket(a);n.ws=r,r.onopen=n.openSocket,r.onmessage=n.onMessage,r.onclose=n.closeSocket},n.openSocket=function(){n.ws.send("RG#"+n.deviceId)},n.closeSocket=function(){},n.onMessage=function(t){if(console.log("data:",t.data),t.data.startsWith("NF#")){var e=JSON.parse(t.data.substr(3));n.props.onData(e)}else if(!n.hbStarted&&t.data.startsWith("RO#"))return console.log("login successfully"),n.registered||(n.registered=!0,n.ws.send(JSON.stringify(n.reg))),n.hbStarted=!0,void setInterval((function(){n.ws.send("H1")}),15e3)};var r=window.localStorage.getItem("s-admin-deviceId");n.deviceId=r||m.a().replace(/-/g,"").substr(0,8),window.localStorage.setItem("s-admin-deviceId",n.deviceId);var s=new Date;return n.reg={method:"GET",host:"".concat(t.baseUrl,":8080"),querys:{docId:"devs",type:"admin",userId:n.deviceId},headers:{"x-ca-websocket_api_type":["REGISTER"],"x-ca-seq":["0"],"x-ca-nonce":[m.a().toString()],date:[s.toUTCString()],"x-ca-timestamp":[s.getTime().toString()],CA_VERSION:["1"]},path:"/r",body:""},n}return Object(l.a)(a,[{key:"render",value:function(){return Object(O.jsx)("div",{})}}]),a}(n.Component);a(78);var w=function(t){return Object(O.jsxs)("div",{className:"barrage-item-container",children:[Object(O.jsxs)("div",{className:"barrage-item-top",children:[Object(O.jsxs)("div",{className:"basic-info",children:[Object(O.jsxs)("div",{className:"item",children:[" ",Object(O.jsx)("span",{children:"\u5f39\u5e55\u7f16\u53f7\uff1a"}),Object(O.jsx)("span",{children:t.data.id})]}),Object(O.jsxs)("div",{className:"item",children:[" ",Object(O.jsx)("span",{children:"\u5f39\u5e55\u4f5c\u8005\uff1a"}),Object(O.jsx)("span",{children:t.data.fromName})]})]}),Object(O.jsx)("div",{className:"barrage-content",children:t.data.message})]}),Object(O.jsxs)("div",{className:"barrage-item-bottom",children:[Object(O.jsx)(v.a,{type:"primary",className:"btn",onClick:function(){return t.updateCheckStatus(t.data.id,1)},children:"\u901a\u8fc7"}),Object(O.jsx)(v.a,{className:"btn",onClick:function(){return t.updateCheckStatus(t.data.id,2)},children:"\u62d2\u7edd"})]})]})},S=[{label:"\u65e0\u63a7\u5236",value:0},{label:"\u8bbe\u7f6e\u8fc7\u6ee4\u5b57\u6bb5",value:1},{label:"\u8bbe\u7f6e\u7ba1\u7406\u5458\u62e6\u622a",value:2}];f.a.defaults.baseURL="/api";var k=function(t){Object(p.a)(a,t);var e=Object(b.a)(a);function a(t){var n;return Object(d.a)(this,a),(n=e.call(this,t)).componentDidMount=Object(u.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.getBarragesList();case 2:return t.next=4,n.getControlStatus();case 4:case"end":return t.stop()}}),t)}))),n.getBarragesList=Object(u.a)(o.a.mark((function t(){var e,a,r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f.a.get("/barrage");case 2:e=t.sent,a=e.data,r=Object.keys(a).map((function(t){return a[t]})).filter((function(t){return 0===t.checkStatus})),n.setState({barrages:r});case 6:case"end":return t.stop()}}),t)}))),n.getControlStatus=Object(u.a)(o.a.mark((function t(){var e,a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f.a.get("/status");case 2:e=t.sent,a=e.data,n.setState({status:a.status||0,filterWords:a.filterWords||[]});case 5:case"end":return t.stop()}}),t)}))),n.updateCheckStatus=function(){var t=Object(u.a)(o.a.mark((function t(e,a){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f.a.put("/barrage/".concat(e),{checkStatus:a});case 2:return t.sent,t.next=5,n.getBarragesList();case 5:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),n.changeControl=function(t){n.setState({status:t})},n.confirmUpdate=Object(u.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:h.a.confirm({content:"\u786e\u8ba4\u4fee\u6539\u914d\u7f6e\uff1f",onOk:function(){var t=Object(u.a)(o.a.mark((function t(){var e,a,r,s;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.state,a=e.status,r=e.filterWords,t.next=3,f.a.post("/status",{status:a,filterWords:r});case 3:s=t.sent,console.log(s);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()});case 1:case"end":return t.stop()}}),t)}))),n.setBarrageList=function(t){var e=n.state.barrages;e.push(t),n.setState({barrages:e})},n.renderOption=function(t,e,a){return Object(O.jsxs)("div",{children:[Object(O.jsx)("a",{href:"javascript:void(0)",style:{marginRight:10},onClick:function(){n.updateCheckStatus(t,1)},children:"\u901a\u8fc7"}),Object(O.jsx)("a",{href:"javascript:void(0)",style:{marginRight:10},onClick:function(){n.updateCheckStatus(t,2)},children:"\u62d2\u7edd"})]})},n.state={barrages:[],status:0,filterWords:[]},n}return Object(l.a)(a,[{key:"render",value:function(){var t=this,e=this.state,a=e.barrages,n=e.status;return Object(O.jsxs)("div",{className:"barrage-list-container",style:{paddingTop:60,overflowY:"auto"},children:[Object(O.jsx)(x,{baseUrl:window.location.host,onData:function(e){return t.setBarrageList(e)}}),Object(O.jsxs)("div",{className:"control-container",children:[Object(O.jsx)("span",{className:"control-span",children:"\u5f53\u524d\u63a7\u5236\u72b6\u6001: "})," ",Object(O.jsx)(g.a,{dataSource:S,value:n,onChange:this.changeControl,style:{marginRight:20}}),Object(O.jsx)(v.a,{type:"primary",onClick:this.confirmUpdate,children:"\u786e\u8ba4\u4fee\u6539"})]}),Object(O.jsx)("div",{className:"barrage-list",children:a.map((function(e){return Object(O.jsx)(w,{data:e,updateCheckStatus:t.updateCheckStatus},e.id)}))})]})}}]),a}(n.Component);a(180),a(181);var C=function(){return Object(O.jsx)("div",{className:"App",children:Object(O.jsx)(k,{})})},y=function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,188)).then((function(e){var a=e.getCLS,n=e.getFID,r=e.getFCP,s=e.getLCP,c=e.getTTFB;a(t),n(t),r(t),s(t),c(t)}))};c.a.render(Object(O.jsx)(r.a.StrictMode,{children:Object(O.jsx)(C,{})}),document.getElementById("root")),y()},78:function(t,e,a){}},[[182,1,2]]]);
//# sourceMappingURL=main.02ca2cc4.chunk.js.map